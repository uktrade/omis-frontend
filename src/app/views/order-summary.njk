{% extends '_layouts/omis-base.njk' %}

{% block main_content %}
  <h1>{{ order.reference }}</h1>

  {% if order.status === 'complete' %}
    {% include '_includes/messages/order-complete.njk' %}
  {% endif %}

  {% if invoice %}
    <h2>Your invoice</h2>

    {{ MetaList({
      items: [
        { label: 'Invoice number', value: invoice.invoice_number },
        { label: 'Created on', value: invoice.created_on, type: 'datetime' },
        { label: 'Paid on', value: order.paid_on, type: 'date' }
      ],
      modifier: 'stacked',
      itemModifier: 'stacked'
    }) }}

    {% if invoice.invoice_company_name %}
      <p>
        <a href="/{{ publicToken }}/invoice">View your invoice</a>
      </p>
    {% endif %}

    {% if order.status in ['paid', 'complete'] %}
      <p>
        <a href="/{{ publicToken }}/receipt">View your payment receipt</a>
      </p>
    {% endif %}

    {% if not invoice.invoice_company_name %}
      {% include '_includes/messages/legacy-invoice.njk' %}
    {% endif %}
  {% endif %}

  <h2>Your quote</h2>

  {% set expiryValue %}
    {{ quote.expires_on | formatDate }} ({{ quote.expires_on | fromNow }})
  {% endset %}

  {{ MetaList({
    items: [
      { label: 'We sent it on', value: quote.created_on, type: 'datetime' },
      { label: 'Expiry date', value: expiryValue if not quote.accepted_on },
      { label: 'You accepted it on', value: quote.accepted_on, type: 'datetime' }
    ],
    modifier: 'stacked',
    itemModifier: 'stacked'
  }) }}

    <p>
      <a href="/{{ publicToken }}/quote" class="{{ 'button' if not quote.accepted_on }}">
        View your
        {{ 'accepted' if quote.accepted_on }}
        quote
      </a>
    </p>
{% endblock  %}
